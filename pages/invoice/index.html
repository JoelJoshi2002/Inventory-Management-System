<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../styles/cms.css" />
    <link rel="stylesheet" href="../../styles/cms_thm.css" />
    <title>Invoice Entry</title>
  </head>

  <body>
    <!--Form For Inputing Data -->
    <div
      class="klub_tab_tl1_x cms_tile_hldr"
      align="center"
      style="background-color: #fffaf1"
    >
      <form
        onsubmit="postData(event)"
        id="defaultform"
        method="post"
        action=""
        enctype="multipart/form-data"
      >
        <table>
          <tr>
            <td>
              <label for="invoicenumber">Invoice Number: </label>
            </td>
            <td>
              <input
                type="text"
                required
                name="invoicenumber"
                id="invoicenumber"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="invoicedate">Invoice Date: </label>
            </td>
            <td>
              <input
                type="date"
                required
                name="invoicedate"
                id="invoicedate"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="delivereddate">Delivered Date: </label>
            </td>
            <td>
              <input
                type="date"
                required
                name="delivereddate"
                id="delivereddate"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="supplier">Supplier: </label>
            </td>
            <td>
              <input
                type="text"
                required
                list="supplierDataList"
                name="supplier"
                id="suppliers"
                class="klub_input klub_h3 cms_inp_det1"
                oninput="getSuppliers()"
                onchange="getSupplierData()"
              />
              <datalist id="supplierDataList"> </datalist>
              <a href="../supplier/" class="button-3" role="button"
                >Add Supplier</a
              >
            </td>
          </tr>
          <tr>
            <td>
              <label for="supplier">Supplier: </label>
            </td>
            <td>
              <input
                type="text"
                required
                disabled
                name="supplierName"
                id="supplierName"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="supplier">Supplier Address: </label>
            </td>
            <td>
              <input
                type="text"
                required
                disabled
                name="supplierAddress"
                id="supplierAddress"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="ponumber">PO Number: </label>
            </td>
            <td>
              <input
                type="text"
                name="ponumber"
                id="ponumber"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="podate">PO Date: </label>
            </td>
            <td>
              <input
                type="date"
                name="podate"
                id="podate"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="numberofitems">Number of Items: </label>
            </td>
            <td>
              <input
                type="text"
                required
                name="numberofitems"
                id="numberofitems"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="amount">Amount : </label>
            </td>
            <td>
              <input
                type="text"
                required
                name="amount"
                id="amount"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="sgst">SGST: </label>
            </td>
            <td>
              <input
                type="text"
                name="sgst"
                id="sgst"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="cgst">CGST: </label>
            </td>
            <td>
              <input
                type="text"
                name="cgst"
                id="cgst"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="igst">IGST: </label>
            </td>
            <td>
              <input
                type="text"
                name="igst"
                id="igst"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="totalamount">Total Amount: </label>
            </td>
            <td>
              <input
                type="text"
                required
                name="totalamount"
                id="totalamount"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="totalafterdiscount">Total After Discount: </label>
            </td>
            <td>
              <input
                type="text"
                required
                name="totalafterdiscount"
                id="totalafterdiscount"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="amount_paid_on">Amount Paid On: </label>
            </td>
            <td>
              <input
                type="date"
                name="amount_paid_on"
                id="amount_paid_on"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="payment_status">Payment Status: </label>
            </td>
            <td>
              <input
                type="text"
                name="payment_status"
                id="payment_status"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>

          <tr>
            <td>
              <label for="payment_remarks">Payment Remarks: </label>
            </td>
            <td>
              <input
                type="text"
                name="payment_remarks"
                id="payment_remarks"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr></tr>
          <tr>
            <td>
              <label for="remarks">Remarks: </label>
            </td>
            <td>
              <input
                type="text"
                name="remarks"
                id="remarks"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <!-- <tr>
            <td>
              <label for="dept_no">Department Number: </label>
            </td>
            <td>
              <input
                type="text"
                name="dept_no"
                id="dept_no"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <label for="staff_id">Staff ID: </label>
            </td>
            <td>
              <input
                type="text"
                name="staff_id"
                id="staff_id"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr> -->
            <td>
              <label for="invfile">Upload Invoice: </label>
            </td>
            <td>
              <input
                type="file"
                name="invfile"
                id="invfile"
                accept=".pdf"
                class="klub_input klub_h3 cms_inp_det1"
              />
            </td>
          </tr>
          <tr>
            <td>
              <input
                class="btn btn-success"
                role="button"
                type="submit"
                name="submit"
                value="Submit"
              />
            </td>
            <td><h3 id="resmsg"></h3></td>
          </tr>
        </table>
      </form>
      <br />
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <script type="text/javascript">
      function postData(event) {
        event.preventDefault();

        var httpxml = new XMLHttpRequest();
        $.ajax({
          method: "POST",
          url: "invoice.php",
          processData: false,
          contentType: false,
          data: new FormData(document.getElementById("defaultform")),
          success: () => {
            $("#resmsg").addClass("klub_h3");
            $("#resmsg")[0].innerText = "Entry Added Successfully";
            $("#defaultform")[0].reset();
          },
          error: () => {
            $("#resmsg").addClass("klub_tbar_container");
            $("#resmsg").text = "Error";
          },
        });
      }
    </script>

    <script type="text/javascript">
      function getSuppliers() {
        var httpxml = new XMLHttpRequest();

        function stateck() {
          if (httpxml.readyState == 4) {
            document.getElementById("supplierDataList").innerHTML =
              httpxml.responseText;
          }
        }
        var url = "getSuppliers.php";
        httpxml.onreadystatechange = stateck;
        httpxml.open("GET", url, true);
        httpxml.send(null);
      }
    </script>

    <script type="text/javascript">
      function getSupplierData() {
        let formData = new FormData();
        let textField = $("#suppliers").val();
        formData.append("supplier", textField);
        var httpxml = new XMLHttpRequest();
        $.ajax({
          method: "POST",
          url: "getSingleSupplier.php",
          processData: false,
          contentType: false,
          data: formData,
          success: (response) => {
            console.log(response);
            const res = response.split(",");
            $("#supplierName").val(res[0]);
            $("#supplierAddress").val(res[1]);
          },
          error: () => {
            $("#supplierAddress").val("Error");
          },
        });
      }
    </script>
  </body>
</html>
